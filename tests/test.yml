---
- hosts: localhost
  remote_user: root
  roles:
    - role: telusdigital.slack
      slack_dry_run: yes
      when: autodeploy_slack_notifications_enabled
    - role: telusdigital.postgresql
      postgresql_client: yes
      when: "autodeploy_database_engine == 'postgres' and autodeploy_database_bundled"
    - role: telusdigital.mariadb
      mariadb_client: yes
      when: "autodeploy_database_engine == 'mysql-compatible' and autodeploy_database_bundled"
    - role: telusdigital.nodejs
      when: autodeploy_listener == 'node'
    - role: telusdigital.upstart
      upstart_name: autodeploy
      upstart_exec_path: "/usr/bin/node /data/deployment/listener.js"
      when: autodeploy_listener == 'node'
    - role: telusdigital.php
      when: autodeploy_listener == 'php'
    - role: telusdigital.yo-dawg
    - role: ansible-autodeploy
  vars:
    system_role: travis
    project: travis
    environment_tier: travis
    domain: travis
